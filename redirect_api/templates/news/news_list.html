{% extends 'base.html' %}
{% load static %}
{% block title %}News Sources and Articles{% endblock %}
{% block content %}
    <div class="row">
        <div class="col-md-3 sticky-sidebar">
            <div class="list-group">
                {% for news_source in news_sources %}
                    <a href="#news-source-{{ forloop.counter }}" class="list-group-item list-group-item-action" data-target="#news-source-{{ forloop.counter }}">{{ news_source.name }}</a>
                {% endfor %}
            </div>
        </div>
        <div class="col-md-9 main-content">
            <h1 class="mb-4">News List</h1>
            <div class="date-navigation">
                <a href="{% url 'news:news_list' published_at.year published_at.month published_at.day|add:'-1' %}" class="btn btn-secondary">&lt;</a>
                <input type="text" id="datePicker" class="form-control" value="{{ published_at|date:'Y-m-d' }}">
                <a href="{% url 'news:news_list' published_at.year published_at.month published_at.day|add:'1' %}" class="btn btn-secondary">&gt;</a>
            </div>
            {% for news_source in news_sources %}
                <div class="card mb-4" id="news-source-{{ forloop.counter }}">
                    <div class="card-body">
                        <h2 class="card-title"><a href="{{ news_source.url }}" target="_blank">{{ news_source.name }}</a></h2>
                        <ul class="list-group">
                            {% for article in news_source.published_articles %}
                            <li class="list-group-item d-flex justify-content-between align-items-center article-item" data-article-id="{{ article.id }}">
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input hide-checkbox" id="article-{{ article.id }}" data-article-id="{{ article.id }}">
                                    <label class="form-check-label" for="article-{{ article.id }}"></label>
                                </div>
                                <a href="{{ article.url }}" target="_blank">{{ article.title }}</a>
                            </li>
                            {% empty %}
                            <li class="list-group-item">No articles found for this news source on {{ published_at|date:"F j, Y" }}.</li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            {% empty %}
                <p>No news sources found.</p>
            {% endfor %}
        </div>
    </div>

    <form id="hideForm" method="post" action="{% url 'news:hide_articles' published_at.year published_at.month published_at.day %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-primary hide-button" id="hideButton">記事を隠す</button>
    </form>
{% endblock %}
{% block script %}
    <script src="{% static 'js/news.js' %}"></script>
{% endblock %}